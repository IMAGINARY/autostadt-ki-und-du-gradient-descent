!function i(u,a,s){function c(t,e){if(!a[t]){if(!u[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(l)return l(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var o=a[t]={exports:{}};u[t][0].call(o.exports,function(e){return c(u[t][1][e]||e)},o,o.exports,i,u,a,s)}return a[t].exports}for(var l="function"==typeof require&&require,e=0;e<s.length;e++)c(s[e]);return c}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,a=(r=e("./game-mode"))&&r.__esModule?r:{default:r};function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t,n,r,o,i,u){try{var a=e[i](u),s=a.value}catch(e){return void n(e)}a.done?t(s):Promise.resolve(s).then(r,o)}function c(a){return function(){var e=this,u=arguments;return new Promise(function(t,n){var r=a.apply(e,u);function o(e){s(r,t,n,o,i,"next",e)}function i(e){s(r,t,n,o,i,"throw",e)}o(void 0)})}}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(i){return function(){var e,t,n,r=p(i);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(e){return}}()){var o=p(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return t=this,!(n=e)||"object"!==u(n)&&"function"!=typeof n?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):n}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var o=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(u,a["default"]);var e,t,n,r,o,i=d(u);function u(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),i.apply(this,arguments)}return e=u,(t=[{key:"handleEnterMode",value:(o=c(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)})),function(){return o.apply(this,arguments)})},{key:"handleExitMode",value:(r=c(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)})),function(){return r.apply(this,arguments)})},{key:"handleInput",value:function(){}},{key:"draw",value:function(){}}])&&l(e.prototype,t),n&&l(e,n),u}();n.default=o},{"./game-mode":2}],2:[function(e,t,n){"use strict";function s(e,t,n,r,o,i,u){try{var a=e[i](u),s=a.value}catch(e){return void n(e)}a.done?t(s):Promise.resolve(s).then(r,o)}function a(a){return function(){var e=this,u=arguments;return new Promise(function(t,n){var r=a.apply(e,u);function o(e){s(r,t,n,o,i,"next",e)}function i(e){s(r,t,n,o,i,"throw",e)}o(void 0)})}}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.game=e}var e,n,r,o,i,u;return e=t,(n=[{key:"preLoadAssets",value:(u=a(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)})),function(){return u.apply(this,arguments)})},{key:"handleEnterMode",value:(i=a(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)})),function(){return i.apply(this,arguments)})},{key:"handleExitMode",value:(o=a(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)})),function(){return o.apply(this,arguments)})},{key:"handleInput",value:function(){}},{key:"draw",value:function(){}}])&&c(e.prototype,n),r&&c(e,r),t}();n.default=r},{}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("./game-mode-play")),s=r(e("./screen-controls"));function r(e){return e&&e.__esModule?e:{default:e}}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t,n,r,o,i,u){try{var a=e[i](u),s=a.value}catch(e){return void n(e)}a.done?t(s):Promise.resolve(s).then(r,o)}function f(a){return function(){var e=this,u=arguments;return new Promise(function(t,n){var r=a.apply(e,u);function o(e){l(r,t,n,o,i,"next",e)}function i(e){l(r,t,n,o,i,"throw",e)}o(void 0)})}}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.container=e,this.config=t,this.input=[],this.inputLast=[],this.initInput(),this.isPaused=!1,this.modes={},this.currentMode=null,this.screenControls=null,this.debugControlsPane=null}var e,t,r,o,i,u;return e=n,(t=[{key:"init",value:(u=f(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.svg=SVG().addTo(this.container),this.config.useScreenControls&&(this.screenControls=new s.default(this.config.maxPlayers),this.container.appendChild(this.screenControls.element)),this.config.debugControls&&(this.debugControlsPane=document.createElement("div"),this.debugControlsPane.classList.add("debug-pane"),this.debugControlsPane.classList.add("debug-pane-controls"),this.container.appendChild(this.debugControlsPane)),e.next=5,this.registerMode("play",new a.default(this));case 5:return t=Object.entries(this.modes).map(function(e){var t=c(e,2)[1];return function(){t.preLoadAssets()}}),e.next=8,Promise.all(t);case 8:return e.next=10,this.setMode("play");case 10:case"end":return e.stop()}},e,this)})),function(){return u.apply(this,arguments)})},{key:"initInput",value:function(){this.input=Array(this.config.maxPlayers).fill(null).map(function(){return{direction:0,action:!1}})}},{key:"readInput",value:function(){var n=this;this.inputLast=this.input,this.initInput(),this.screenControls&&this.screenControls.getState().forEach(function(e,t){e.left&&(n.input[t].direction=-1),e.right&&(n.input[t].direction=1),n.input[t].action=n.input[t].action||e.action}),this.config.useGamepads&&Array.from(navigator.getGamepads()).forEach(function(e,t){null!==e&&(e.axes[0]<-.5&&(n.input[t].direction=-1),.5<e.axes[0]&&(n.input[t].direction=1),n.input[t].action=n.input[t].action||e.buttons[1].pressed||e.buttons[2].pressed)}),this.debugControlsPane&&(this.debugControlsPane.textContent=this.input.map(function(e,t){return"C".concat(t,": d=").concat(e.direction," a=").concat(e.action?"T":"F")}).join("    "))}},{key:"run",value:function(){var n=this;window.requestAnimationFrame(function e(t){n.isPaused||(n.readInput(),n.currentMode.handleInput(n.input,n.inputLast),n.currentMode.draw(t),window.requestAnimationFrame(e))})}},{key:"pause",value:function(){this.isPaused=!0}},{key:"resume",value:function(){this.isPaused&&(this.isPaused=!1,this.run())}},{key:"registerMode",value:(i=f(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.modes[t]=n;case 1:case"end":return e.stop()}},e,this)})),function(e,t){return i.apply(this,arguments)})},{key:"setMode",value:(o=f(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.pause(),this.currentMode)return e.next=4,this.currentMode.handleExitMode();e.next=4;break;case 4:if(void 0===this.modes[t])throw new Error("Can't change to unknown mode ".concat(t));e.next=6;break;case 6:return this.currentMode=this.modes[t],e.next=9,this.currentMode.handleEnterMode();case 9:this.resume();case 10:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})}])&&d(e.prototype,t),r&&d(e,r),n}();n.default=i},{"./game-mode-play":1,"./screen-controls":5}],4:[function(e,t,n){"use strict";var r,o=(r=e("./game"))&&r.__esModule?r:{default:r};function s(e,t,n,r,o,i,u){try{var a=e[i](u),s=a.value}catch(e){return void n(e)}a.done?t(s):Promise.resolve(s).then(r,o)}function i(a){return function(){var e=this,u=arguments;return new Promise(function(t,n){var r=a.apply(e,u);function o(e){s(r,t,n,o,i,"next",e)}function i(e){s(r,t,n,o,i,"throw",e)}o(void 0)})}}var u,a={defaultLanguage:"en",useGamepads:!0,useScreenControls:!0,maxPlayers:2,debugControls:!1};function c(){return l.apply(this,arguments)}function l(){return(l=i(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if(200<=(n=e.sent).status&&n.status<300)return e.prev=4,e.next=7,n.json();e.next=13;break;case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(4),new Error("Error parsing config file: ".concat(e.t0.message));case 13:throw new Error("Server returned status ".concat(n.status," (").concat(n.statusText,") loading config file."));case 14:case"end":return e.stop()}},e,null,[[4,10]])}))).apply(this,arguments)}u=i(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=Object,e.t1={},e.t2=a,e.next=6,c("./config.json");case 6:return e.t3=e.sent,t=e.t0.assign.call(e.t0,e.t1,e.t2,e.t3),e.next=10,IMAGINARY.i18n.init({queryStringVariable:"lang",translationsDirectory:"tr",defaultLanguage:t.defaultLanguage||"en"});case 10:return n=new o.default(document.querySelector(".main"),t),e.next=13,n.init();case 13:n.run(),e.next=19;break;case 16:e.prev=16,e.t4=e.catch(0),console.error(e.t4);case 19:case"end":return e.stop()}},e,null,[[0,16]])})),function(){u.apply(this,arguments)}()},{"./game":3}],5:[function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(){function r(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.element=document.createElement("div"),this.element.classList.add("screen-controls"),this.element.classList.add("with-".concat(e,"-controls")),this.state=[];for(var n=0;n<e;n+=1)this.state.push({left:!1,right:!1,action:!1}),this.element.appendChild(this.buildControl(n));this.mousePressedButton=null,window.addEventListener("mouseup",function(){null!==t.mousePressedButton&&(t.state[t.mousePressedButton.id][t.mousePressedButton.name]=!1,t.mousePressedButton.element.classList.remove("active"),t.mousePressedButton=null)})}var e,t,n;return e=r,(t=[{key:"buildControl",value:function(r){var o=this,e=document.createElement("div");e.classList.add("screen-control","screen-control-".concat(r));function t(t){var n=document.createElement("button");function e(e){0<e.targetTouches.length?(o.state[r][t]=!0,n.classList.add("active")):(o.state[r][t]=!1,n.classList.remove("active")),e.preventDefault()}return n.setAttribute("type","button"),n.classList.add(t),n.addEventListener("touchstart",e,{passive:!1}),n.addEventListener("touchmove",e,{passive:!1}),n.addEventListener("touchend",e,{passive:!1}),n.addEventListener("touchcancel",e,{passive:!1}),n.addEventListener("mousedown",function(){o.state[r][t]=!0,n.classList.add("active"),o.mousePressedButton={id:r,name:t,element:n}}),n}return e.appendChild(t("left")),e.appendChild(t("action")),e.appendChild(t("right")),e}},{key:"getState",value:function(){return this.state}}])&&o(e.prototype,t),n&&o(e,n),r}();n.default=r},{}]},{},[4]);
//# sourceMappingURL=bundle.min.js.map
